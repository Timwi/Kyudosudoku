using System.Collections.Generic;
using System.Linq;
using PuzzleSolvers;
using RT.Util;
using RT.Util.ExtensionMethods;

namespace KyudosudokuWebsite
{
    sealed class Skyscraper : KyuRowColConstraint
    {
        public override string Name => "Skyscraper";
        public override string Description => $"Within this {(IsCol ? "column" : "row")}, the digits represent skyscrapers, where taller ones obstruct smaller ones behind them. {Clue} skyscrapers are visible from the clue.";
        public override double ExtraTop => IsCol && !Reverse ? .5 : 0;
        public override double ExtraRight => !IsCol && Reverse ? .5 : 0;
        public override bool ShownTopLeft => !Reverse;
        public static readonly Example Example = new Example
        {
            Constraints = { new Skyscraper(false, 0, false, 3) },
            Cells = { 0, 1, 2, 3, 4, 5, 6, 7, 8 },
            Good = { 2, 7, 5, 9, 6, 1, 4, 3, 8 },
            Bad = { 2, 7, 8, 5, 9, 6, 1, 4, 3 },
            Reason = "The 8 obstructs the 5, and the 9 obstructs the rest of the row, leaving 4 skyscrapers visible (2, 7, 8, 9).",
            Wide = true
        };

        public Skyscraper(bool isCol, int rowCol, bool reverse, int clue) : base(isCol, rowCol)
        {
            Clue = clue;
            Reverse = reverse;
        }
        private Skyscraper() { }    // for Classify

        public int Clue { get; private set; }
        public bool Reverse { get; private set; }

        protected override Constraint getConstraint() => new SkyscraperUniquenessConstraint(Clue, GetAffectedCells(Reverse));

        public override bool Verify(int[] grid) => SkyscraperUniquenessConstraint.CalculateSkyscraperClue(GetAffectedCells(Reverse).Select(cell => grid[cell])) == Clue;

        public override string Svg => $@"<g transform='translate({(IsCol ? RowCol : Reverse ? 8.9 : -1)}, {(IsCol ? (Reverse ? 9.85 : -.85) : RowCol + .08)}) scale(.00175)'>
            <path fill='#80d7f0' d='M262.5 201.25l5 5v-5zM262.5 191.25l5 5v-5zM262.5 211.25l5 5v-5zM262.5 181.25l5 5v-5zM252.5 231.25l5 5v-5zM262.5 221.25l5 5v-5zM252.5 121.25l5 5v-5zM252.5 111.25l5 5v-5zM242.5 151.25l5 5v-5zM252.5 131.25l5 5v-5zM232.5 151.25l5 5v-5zM217.5 221.25h-5l5 5zM252.5 311.25l5 5v-5zM252.5 341.25l5 5v-5zM252.5 330l5 5v-5zM252.5 361.25l5 5v-5zM252.5 371.25l5 5v-5zM252.5 250l5 5v-5zM252.5 301.25l5 5v-5zM252.5 261.25l5 5v-5zM252.5 101.25l5 5v-5zM252.5 291.25l5 5v-5zM252.5 281.25l5 5v-5zM252.5 351.25l5 5v-5zM232.5 71.25l5 5v-5zM217.5 131.25h-5l5 5zM217.5 141.25h-5l5 5zM217.5 111.25h-5l5 5zM217.5 121.25h-5l5 5zM217.5 170h-5l5 5zM217.5 201.25h-5l5 5zM217.5 211.25h-5l5 5zM217.5 181.25h-5l5 5zM217.5 191.25h-5l5 5zM217.5 101.25h-5l5 5zM217.5 151.25h-5l5 5zM242.5 31.25l5 5v-5zM242.5 41.25l5 5v-5zM227.5 21.25h-5l5 5zM242.5 51.25l5 5v-5zM217.5 90h-5l5 5zM242.5 61.25l5 5v-5zM217.5 61.25h-5l5 5zM217.5 71.25h-5l5 5zM217.5 31.25h-5l5 5zM217.5 51.25h-5l5 5zM217.5 41.25h-5l5 5zM252.5 271.25l5 5v-5zM227.5 90h-5l5 5zM227.5 131.25h-5l5 5zM227.5 101.25h-5l5 5zM227.5 141.25h-5l5 5zM227.5 111.25h-5l5 5zM227.5 121.25h-5l5 5zM227.5 201.25h-5l5 5zM227.5 191.25h-5l5 5zM227.5 181.25h-5l5 5zM227.5 151.25h-5l5 5zM252.5 381.25l5 5v-5zM227.5 211.25h-5l5 5zM232.5 51.25l5 5v-5zM242.5 111.25l5 5v-5zM242.5 121.25l5 5v-5zM227.5 71.25h-5l5 5zM242.5 131.25l5 5v-5zM232.5 141.25l5 5v-5zM237.5 41.25h-5l5 5zM227.5 61.25h-5l5 5zM227.5 51.25h-5l5 5zM237.5 31.25h-5l5 5zM227.5 41.25h-5l5 5zM227.5 170h-5l5 5zM227.5 410h-5l5 5zM227.5 391.25h-5l5 5zM227.5 421.25h-5l5 5zM227.5 381.25h-5l5 5zM227.5 371.25h-5l5 5zM252.5 431.25l5 5v-5zM252.5 410l5 5v-5zM252.5 391.25l5 5v-5zM227.5 431.25h-5l5 5zM227.5 361.25h-5l5 5zM252.5 421.25l5 5v-5zM227.5 330h-5l5 5zM227.5 261.25h-5l5 5zM227.5 271.25h-5l5 5zM227.5 231.25h-5l5 5zM227.5 250h-5l5 5zM227.5 281.25h-5l5 5zM227.5 301.25h-5l5 5zM227.5 221.25h-5l5 5zM227.5 341.25h-5l5 5zM227.5 351.25h-5l5 5zM227.5 311.25h-5l5 5zM227.5 291.25h-5l5 5zM252.5 141.25l5 5v-5zM207.5 361.25h-5l5 5zM207.5 371.25h-5l5 5zM207.5 351.25h-5l5 5zM207.5 311.25h-5l5 5zM207.5 341.25h-5l5 5zM207.5 330h-5l5 5zM207.5 431.25h-5l5 5zM207.5 421.25h-5l5 5zM207.5 410h-5l5 5zM207.5 391.25h-5l5 5zM207.5 381.25h-5l5 5zM207.5 181.25h-5l5 5zM207.5 201.25h-5l5 5zM207.5 191.25h-5l5 5zM207.5 441.25h-5l5 5zM207.5 141.25h-5l5 5zM207.5 211.25h-5l5 5zM207.5 221.25h-5l5 5zM207.5 291.25h-5l5 5zM207.5 301.25h-5l5 5zM207.5 281.25h-5l5 5zM207.5 261.25h-5l5 5zM207.5 271.25h-5l5 5zM272.5 391.25l5 5v-5zM272.5 291.25l5 5v-5zM272.5 281.25l5 5v-5zM207.5 451.25h-5l5 5zM272.5 330l5 5v-5zM272.5 301.25l5 5v-5zM272.5 311.25l5 5v-5zM242.5 471.25h-10l8.75 8.75h6.25v-8.75zM222.5 471.25h-20l8.75 8.75h16.25v-8.75zM272.5 471.25h-20l8.75 8.75h16.25v-8.75zM272.5 261.25l5 5v-5zM217.5 231.25h-5l5 5zM272.5 271.25l5 5v-5zM272.5 431.25l5 5v-5zM272.5 410l5 5v-5zM272.5 421.25l5 5v-5zM272.5 441.25l5 5v-5zM272.5 451.25l5 5v-5zM272.5 381.25l5 5v-5zM207.5 131.25h-5l5 5zM272.5 361.25l5 5v-5zM272.5 351.25l5 5v-5zM272.5 341.25l5 5v-5zM272.5 371.25l5 5v-5zM277.5 255v-5h-5zM217.5 371.25h-5l5 5zM217.5 421.25h-5l5 5zM217.5 410h-5l5 5zM217.5 391.25h-5l5 5zM217.5 381.25h-5l5 5zM217.5 431.25h-5l5 5zM262.5 391.25l5 5v-5zM262.5 410l5 5v-5zM262.5 421.25l5 5v-5zM262.5 431.25l5 5v-5zM262.5 441.25l5 5v-5zM217.5 441.25h-5l5 5zM217.5 281.25h-5l5 5zM217.5 271.25h-5l5 5zM217.5 250h-5l5 5zM217.5 361.25h-5l5 5zM217.5 261.25h-5l5 5zM217.5 291.25h-5l5 5zM217.5 351.25h-5l5 5zM217.5 341.25h-5l5 5zM217.5 301.25h-5l5 5zM217.5 311.25h-5l5 5zM217.5 330h-5l5 5zM262.5 250l5 5v-5zM217.5 10h-5l5 5zM207.5 21.25h-5l5 5zM262.5 381.25l5 5v-5zM242.5 71.25l5 5v-5zM252.5 151.25l5 5v-5zM207.5 41.25h-5l5 5zM207.5 111.25h-5l5 5zM207.5 121.25h-5l5 5zM207.5 101.25h-5l5 5zM207.5 51.25h-5l5 5zM207.5 61.25h-5l5 5zM207.5 31.25h-5l5 5zM262.5 330l5 5v-5zM262.5 341.25l5 5v-5zM262.5 351.25l5 5v-5zM262.5 361.25l5 5v-5zM262.5 371.25l5 5v-5zM262.5 291.25l5 5v-5zM262.5 271.25l5 5v-5zM262.5 281.25l5 5v-5zM262.5 311.25l5 5v-5zM262.5 301.25l5 5v-5zM262.5 261.25l5 5v-5zM242.5 271.25l5 5v-5zM237.5 131.25h-5l5 5zM247.5 211.25h-5l5 5zM242.5 201.25l5 5v-5zM237.5 211.25h-5l5 5zM242.5 181.25l5 5v-5zM237.5 191.25h-5l5 5zM237.5 201.25h-5l5 5zM242.5 191.25l5 5v-5zM237.5 181.25h-5l5 5zM232.5 170l5 5v-5zM247.5 141.25h-5l5 5zM242.5 170l5 5v-5zM257.5 186.25v-5h-5zM247.5 106.25v-5h-5zM247.5 431.25h-5l5 5zM232.5 90l5 5v-5zM237.5 431.25h-5l5 5zM237.5 111.25h-5l5 5zM242.5 410l5 5v-5zM257.5 221.25h-5l5 5zM237.5 371.25h-5l5 5zM237.5 361.25h-5l5 5zM237.5 351.25h-5l5 5zM237.5 341.25h-5l5 5zM237.5 381.25h-5l5 5zM237.5 391.25h-5l5 5zM242.5 421.25l5 5v-5zM237.5 421.25h-5l5 5zM237.5 221.25h-5l5 5zM237.5 410h-5l5 5zM237.5 271.25h-5l5 5zM237.5 330h-5l5 5zM237.5 250h-5l5 5zM237.5 231.25h-5l5 5zM237.5 261.25h-5l5 5zM237.5 281.25h-5l5 5zM237.5 311.25h-5l5 5zM237.5 301.25h-5l5 5zM237.5 291.25h-5l5 5zM237.5 121.25h-5l5 5zM247.5 451.25h-5l5 5zM237.5 451.25h-5l5 5zM227.5 451.25h-5l5 5zM207.5 151.25h-5l5 5zM207.5 231.25h-5l5 5zM217.5 451.25h-5l5 5zM267.5 451.25h-5l5 5zM207.5 170h-5l5 5zM207.5 250h-5l5 5zM257.5 451.25h-5l5 5zM257.5 461.25h-5l5 5zM247.5 15v-5h-5zM267.5 461.25h-5l5 5zM237.5 461.25h-5l5 5zM247.5 461.25h-5l5 5zM227.5 461.25h-5l5 5zM207.5 461.25h-5l5 5zM207.5 10h-5l5 5zM217.5 461.25h-5l5 5zM257.5 95v-5h-5zM262.5 231.25l5 5v-5zM207.5 90h-5l5 5zM257.5 441.25h-5l5 5zM267.5 175v-5h-5zM227.5 441.25h-5l5 5zM232.5 21.25l5 5v-5zM227.5 31.25h-5l5 5zM237.5 441.25h-5l5 5zM257.5 175v-5h-5zM247.5 441.25h-5l5 5zM237.5 61.25h-5l5 5zM217.5 21.25h-5l5 5zM227.5 15v-5h-5zM207.5 71.25h-5l5 5zM232.5 10l5 5v-5zM277.5 461.25h-5l5 5zM247.5 95v-5h-5zM247.5 26.25v-5h-5zM232.5 101.25l5 5v-5zM242.5 301.25l5 5v-5zM242.5 231.25l5 5v-5zM242.5 311.25l5 5v-5zM252.5 191.25l5 5v-5zM242.5 381.25l5 5v-5zM242.5 250l5 5v-5zM242.5 341.25l5 5v-5zM252.5 211.25l5 5v-5zM242.5 221.25l5 5v-5zM242.5 261.25l5 5v-5zM252.5 201.25l5 5v-5zM242.5 330l5 5v-5zM242.5 371.25l5 5v-5zM242.5 391.25l5 5v-5zM242.5 361.25l5 5v-5zM242.5 291.25l5 5v-5zM242.5 351.25l5 5v-5zM242.5 281.25l5 5v-5z'/>
            <path fill='#6eb1e2' d='M272.5 240v-70l-10-10V90l-10-10V0h-55v480h5v-8.75h25V480h5v-8.75h15V480h5v-8.75h25V480h5V250l-10-10zm5 15v3.75h-5V250h5v5zm0 13.75h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 11.25h-5v-8.75h5V320zm0 18.75h-5V330h5v8.75zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 11.25h-5v-8.75h5V400zm0 18.75h-5V410h5v8.75zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm-75-7.5h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-11.25h5v8.75h-5V410zm0-18.75h5V400h-5v-8.75zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-11.25h5v8.75h-5V330zm0-18.75h5V320h-5v-8.75zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-40h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-40h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-40h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm10-11.25h5v8.75h-5V10zm35 70h-5v-8.75h5V80zm10 80h-5v-8.75h5V160zm10 98.75h-5V250h5v8.75zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 11.25h-5v-8.75h5V320zm0 18.75h-5V330h5v8.75zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 11.25h-5v-8.75h5V400zm0 18.75h-5V410h5v8.75zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm-55-7.5h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-11.25h5v8.75h-5V410zm0-18.75h5V400h-5v-8.75zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-11.25h5v8.75h-5V330zm0-18.75h5V320h-5v-8.75zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-11.25h5v8.75h-5V250zm0-18.75h5V240h-5v-8.75zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-11.25h5v8.75h-5V170zm0-18.75h5V160h-5v-8.75zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-11.25h5v8.75h-5V90zm0-18.75h5V80h-5v-8.75zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm10-10h5v7.5h-5v-7.5zm25 17.5h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zM237.5 80h-5v-8.75h5V80zm20 28.75h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm-10 11.25h-5v-8.75h5V160zm20 28.75h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm-10 11.25h-5v-8.75h5V240zm0 18.75h-5V250h5v8.75zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 11.25h-5v-8.75h5V320zm0 18.75h-5V330h5v8.75zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 11.25h-5v-8.75h5V400zm0 18.75h-5V410h5v8.75zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm-35-7.5h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-11.25h5v8.75h-5V410zm0-18.75h5V400h-5v-8.75zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-11.25h5v8.75h-5V330zm0-18.75h5V320h-5v-8.75zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-11.25h5v8.75h-5V250zm0-18.75h5V240h-5v-8.75zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-11.25h5v8.75h-5V170zm0-18.75h5V160h-5v-8.75zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-11.25h5v8.75h-5V90zm0-18.75h5V80h-5v-8.75zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm10-10h5v7.5h-5v-7.5zm5 10v7.5h-5v-7.5h5zm0 17.5h-5v-7.5h5v7.5zm10 60h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm-10 10h-5v-7.5h5v7.5zm0 11.25h-5v-8.75h5V160zm20 38.75h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm-10 10h-5v-7.5h5v7.5zm0 11.25h-5v-8.75h5V240zm0 18.75h-5V250h5v8.75zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 11.25h-5v-8.75h5V320zm0 18.75h-5V330h5v8.75zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm0 11.25h-5v-8.75h5V400zm0 18.75h-5V410h5v8.75zm0 10h-5v-7.5h5v7.5zm-15-7.5h5v7.5h-5v-7.5zm0-11.25h5v8.75h-5V410zm0-18.75h5V400h-5v-8.75zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-11.25h5v8.75h-5V330zm0-18.75h5V320h-5v-8.75zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-11.25h5v8.75h-5V250zm0-18.75h5V240h-5v-8.75zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm15 17.5h-5v-7.5h5v7.5zm0 10h-5v-7.5h5v7.5zm-5 10v-7.5h5v7.5h-5zm5-30h-5v-7.5h5v7.5zm-10-10h-5V170h5v8.75zm-5-40v-7.5h5v7.5h-5zm0-17.5h5v7.5h-5v-7.5zm0-10h5v7.5h-5v-7.5zm5-2.5h-5v-7.5h5v7.5zm-5 322.5h5v7.5h-5v-7.5zm10 0h5v7.5h-5v-7.5zm10-202.5v-7.5h5v7.5h-5zm5-42.5v2.5h-5v-7.5h5v5zm-10-7.5h-5V170h5v8.75zm-5-30v-7.5h5v7.5h-5zm5-42.5v2.5h-5v-7.5h5v5zm-10-7.5h-5V90h5v8.75zm-5-30v-7.5h5v7.5h-5zm5-40h-5v-7.5h5v7.5zm-10 2.5v7.5h-5v-7.5h5zm-5 410h5v7.5h-5v-7.5zm10 0h5v7.5h-5v-7.5zm10 0h5v7.5h-5v-7.5zm10 0h5v7.5h-5v-7.5zm15-201.25h-5v-8.75h5V240zm0-65v3.75h-5V170h5v5zm-10 0v3.75h-5V170h5v5zm0-80v3.75h-5V90h5v5zm-10 0v3.75h-5V90h5v5zm0-68.75v2.5h-5v-7.5h5v5zm-10-7.5h-5V10h5v8.75zm-10-3.75v3.75h-5V10h5v5zm-10 6.25v7.5h-5v-7.5h5zm-10 50V80h-5v-8.75h5zm-5 18.75h5v8.75h-5V90zm5 61.25V160h-5v-8.75h5zm-5 18.75h5v8.75h-5V170zm5 61.25V240h-5v-8.75h5zm-5 18.75h5v8.75h-5V250zm10 201.25h5v7.5h-5v-7.5zm10 0h5v7.5h-5v-7.5zm10 0h5v7.5h-5v-7.5zm10 0h5v7.5h-5v-7.5zm10 0h5v7.5h-5v-7.5zm10 0h5v7.5h-5v-7.5zM247.5 15v3.75h-5V10h5v5zm-40-5v8.75h-5V10h5zm-5 458.75v-7.5h5v7.5h-5zm10 0v-7.5h5v7.5h-5zm10 0v-7.5h5v7.5h-5zm10 0v-7.5h5v7.5h-5zm10 0v-7.5h5v7.5h-5zm10 0v-7.5h5v7.5h-5zm10 0v-7.5h5v7.5h-5zm10 0v-7.5h5v7.5h-5z'/>
            <path fill='#95ffff' d='M207.5 18.75V15l-5-5v8.75zM217.5 15l-5-5v8.75h5zM207.5 26.25l-5-5v7.5h5zM217.5 28.75v-2.5l-5-5v7.5zM227.5 26.25l-5-5v7.5h5zM232.5 28.75h5v-2.5l-5-5zM242.5 28.75h5v-2.5l-5-5zM207.5 36.25l-5-5v7.5h5zM217.5 36.25l-5-5v7.5h5zM227.5 38.75v-2.5l-5-5v7.5zM237.5 36.25l-5-5v7.5h5zM242.5 38.75h5v-2.5l-5-5zM207.5 46.25l-5-5v7.5h5zM217.5 46.25l-5-5v7.5h5zM227.5 46.25l-5-5v7.5h5zM237.5 48.75v-2.5l-5-5v7.5zM242.5 48.75h5v-2.5l-5-5zM207.5 56.25l-5-5v7.5h5zM217.5 56.25l-5-5v7.5h5zM227.5 56.25l-5-5v7.5h5zM232.5 58.75h5v-2.5l-5-5zM242.5 58.75h5v-2.5l-5-5zM207.5 66.25l-5-5v7.5h5zM217.5 66.25l-5-5v7.5h5zM227.5 66.25l-5-5v7.5h5zM232.5 61.25v7.5h5v-2.5zM242.5 68.75h5v-2.5l-5-5zM207.5 106.25l-5-5v7.5h5zM217.5 106.25l-5-5v7.5h5zM227.5 106.25l-5-5v7.5h5zM232.5 108.75h5v-2.5l-5-5zM242.5 108.75h5v-2.5l-5-5zM252.5 108.75h5v-2.5l-5-5zM207.5 116.25l-5-5v7.5h5zM217.5 116.25l-5-5v7.5h5zM227.5 116.25l-5-5v7.5h5zM237.5 116.25l-5-5v7.5h5zM242.5 118.75h5v-2.5l-5-5zM252.5 118.75h5v-2.5l-5-5zM207.5 126.25l-5-5v7.5h5zM217.5 126.25l-5-5v7.5h5zM227.5 126.25l-5-5v7.5h5zM237.5 126.25l-5-5v7.5h5zM242.5 128.75h5v-2.5l-5-5zM252.5 128.75h5v-2.5l-5-5zM207.5 136.25l-5-5v7.5h5zM217.5 136.25l-5-5v7.5h5zM227.5 136.25l-5-5v7.5h5zM232.5 131.25v7.5h5v-2.5zM242.5 138.75h5v-2.5l-5-5zM252.5 138.75h5v-2.5l-5-5zM207.5 146.25l-5-5v7.5h5zM217.5 146.25l-5-5v7.5h5zM227.5 146.25l-5-5v7.5h5zM232.5 148.75h5v-2.5l-5-5zM242.5 141.25v7.5h5v-2.5zM252.5 148.75h5v-2.5l-5-5zM207.5 186.25l-5-5v7.5h5zM217.5 186.25l-5-5v7.5h5zM227.5 186.25l-5-5v7.5h5zM237.5 186.25l-5-5v7.5h5zM242.5 188.75h5v-2.5l-5-5zM252.5 188.75h5v-2.5l-5-5zM262.5 188.75h5v-2.5l-5-5zM207.5 196.25l-5-5v7.5h5zM217.5 196.25l-5-5v7.5h5zM227.5 196.25l-5-5v7.5h5zM237.5 196.25l-5-5v7.5h5zM242.5 198.75h5v-2.5l-5-5zM252.5 198.75h5v-2.5l-5-5zM262.5 198.75h5v-2.5l-5-5zM207.5 206.25l-5-5v7.5h5zM217.5 206.25l-5-5v7.5h5zM227.5 206.25l-5-5v7.5h5zM237.5 206.25l-5-5v7.5h5zM242.5 208.75h5v-2.5l-5-5zM252.5 208.75h5v-2.5l-5-5zM262.5 208.75h5v-2.5l-5-5zM207.5 216.25l-5-5v7.5h5zM217.5 216.25l-5-5v7.5h5zM227.5 216.25l-5-5v7.5h5zM237.5 216.25l-5-5v7.5h5zM242.5 211.25v7.5h5v-2.5zM252.5 218.75h5v-2.5l-5-5zM262.5 218.75h5v-2.5l-5-5zM207.5 226.25l-5-5v7.5h5zM217.5 226.25l-5-5v7.5h5zM227.5 226.25l-5-5v7.5h5zM237.5 226.25l-5-5v7.5h5zM242.5 228.75h5v-2.5l-5-5zM252.5 221.25v7.5h5v-2.5zM262.5 228.75h5v-2.5l-5-5zM207.5 266.25l-5-5v7.5h5zM217.5 266.25l-5-5v7.5h5zM227.5 266.25l-5-5v7.5h5zM237.5 266.25l-5-5v7.5h5zM242.5 268.75h5v-2.5l-5-5zM252.5 268.75h5v-2.5l-5-5zM262.5 268.75h5v-2.5l-5-5zM272.5 268.75h5v-2.5l-5-5zM207.5 276.25l-5-5v7.5h5zM217.5 276.25l-5-5v7.5h5zM227.5 276.25l-5-5v7.5h5zM237.5 276.25l-5-5v7.5h5zM242.5 278.75h5v-2.5l-5-5zM252.5 278.75h5v-2.5l-5-5zM262.5 278.75h5v-2.5l-5-5zM272.5 278.75h5v-2.5l-5-5zM207.5 286.25l-5-5v7.5h5zM217.5 286.25l-5-5v7.5h5zM227.5 286.25l-5-5v7.5h5zM237.5 286.25l-5-5v7.5h5zM242.5 288.75h5v-2.5l-5-5zM252.5 288.75h5v-2.5l-5-5zM262.5 288.75h5v-2.5l-5-5zM272.5 288.75h5v-2.5l-5-5zM207.5 296.25l-5-5v7.5h5zM217.5 296.25l-5-5v7.5h5zM227.5 296.25l-5-5v7.5h5zM237.5 296.25l-5-5v7.5h5zM242.5 298.75h5v-2.5l-5-5zM252.5 298.75h5v-2.5l-5-5zM262.5 298.75h5v-2.5l-5-5zM272.5 298.75h5v-2.5l-5-5zM207.5 306.25l-5-5v7.5h5zM217.5 306.25l-5-5v7.5h5zM227.5 306.25l-5-5v7.5h5zM237.5 306.25l-5-5v7.5h5zM242.5 308.75h5v-2.5l-5-5zM252.5 308.75h5v-2.5l-5-5zM262.5 308.75h5v-2.5l-5-5zM272.5 308.75h5v-2.5l-5-5zM207.5 346.25l-5-5v7.5h5zM217.5 346.25l-5-5v7.5h5zM227.5 346.25l-5-5v7.5h5zM237.5 346.25l-5-5v7.5h5zM242.5 348.75h5v-2.5l-5-5zM252.5 348.75h5v-2.5l-5-5zM262.5 348.75h5v-2.5l-5-5zM272.5 348.75h5v-2.5l-5-5zM207.5 356.25l-5-5v7.5h5zM217.5 356.25l-5-5v7.5h5zM227.5 356.25l-5-5v7.5h5zM237.5 356.25l-5-5v7.5h5zM242.5 358.75h5v-2.5l-5-5zM252.5 358.75h5v-2.5l-5-5zM262.5 358.75h5v-2.5l-5-5zM272.5 358.75h5v-2.5l-5-5zM207.5 366.25l-5-5v7.5h5zM217.5 366.25l-5-5v7.5h5zM227.5 366.25l-5-5v7.5h5zM237.5 366.25l-5-5v7.5h5zM242.5 368.75h5v-2.5l-5-5zM252.5 368.75h5v-2.5l-5-5zM262.5 368.75h5v-2.5l-5-5zM272.5 368.75h5v-2.5l-5-5zM207.5 376.25l-5-5v7.5h5zM217.5 376.25l-5-5v7.5h5zM227.5 376.25l-5-5v7.5h5zM237.5 376.25l-5-5v7.5h5zM242.5 378.75h5v-2.5l-5-5zM252.5 378.75h5v-2.5l-5-5zM262.5 378.75h5v-2.5l-5-5zM272.5 378.75h5v-2.5l-5-5zM207.5 386.25l-5-5v7.5h5zM217.5 386.25l-5-5v7.5h5zM227.5 386.25l-5-5v7.5h5zM237.5 386.25l-5-5v7.5h5zM242.5 388.75h5v-2.5l-5-5zM252.5 388.75h5v-2.5l-5-5zM262.5 388.75h5v-2.5l-5-5zM272.5 388.75h5v-2.5l-5-5zM207.5 426.25l-5-5v7.5h5zM217.5 426.25l-5-5v7.5h5zM227.5 426.25l-5-5v7.5h5zM237.5 426.25l-5-5v7.5h5zM242.5 428.75h5v-2.5l-5-5zM252.5 428.75h5v-2.5l-5-5zM262.5 428.75h5v-2.5l-5-5zM272.5 428.75h5v-2.5l-5-5zM207.5 436.25l-5-5v7.5h5zM217.5 436.25l-5-5v7.5h5zM227.5 436.25l-5-5v7.5h5zM237.5 436.25l-5-5v7.5h5zM247.5 436.25l-5-5v7.5h5zM252.5 438.75h5v-2.5l-5-5zM262.5 438.75h5v-2.5l-5-5zM272.5 438.75h5v-2.5l-5-5zM207.5 446.25l-5-5v7.5h5zM217.5 446.25l-5-5v7.5h5zM227.5 446.25l-5-5v7.5h5zM237.5 446.25l-5-5v7.5h5zM247.5 446.25l-5-5v7.5h5zM257.5 446.25l-5-5v7.5h5zM262.5 448.75h5v-2.5l-5-5zM272.5 448.75h5v-2.5l-5-5zM207.5 456.25l-5-5v7.5h5zM217.5 456.25l-5-5v7.5h5zM227.5 456.25l-5-5v7.5h5zM237.5 456.25l-5-5v7.5h5zM247.5 456.25l-5-5v7.5h5zM257.5 456.25l-5-5v7.5h5zM267.5 456.25l-5-5v7.5h5zM272.5 458.75h5v-2.5l-5-5zM202.5 461.25v7.5h5v-2.5zM212.5 461.25v7.5h5v-2.5zM222.5 461.25v7.5h5v-2.5zM232.5 461.25v7.5h5v-2.5zM242.5 461.25v7.5h5v-2.5zM252.5 461.25v7.5h5v-2.5zM262.5 461.25v7.5h5v-2.5zM272.5 461.25v7.5h5v-2.5zM222.5 18.75h5V15l-5-5zM232.5 18.75h5V15l-5-5zM242.5 18.75h5V15l-5-5zM207.5 80v-3.75l-5-5V80zM217.5 76.25l-5-5V80h5zM227.5 76.25l-5-5V80h5zM232.5 80h5v-3.75l-5-5zM242.5 80h5v-3.75l-5-5zM207.5 95l-5-5v8.75h5zM217.5 95l-5-5v8.75h5zM227.5 95l-5-5v8.75h5zM232.5 98.75h5V95l-5-5zM242.5 98.75h5V95l-5-5zM252.5 98.75h5V95l-5-5zM207.5 160v-3.75l-5-5V160zM217.5 156.25l-5-5V160h5zM227.5 156.25l-5-5V160h5zM232.5 160h5v-3.75l-5-5zM242.5 160h5v-3.75l-5-5zM252.5 160h5v-3.75l-5-5zM207.5 175l-5-5v8.75h5zM217.5 175l-5-5v8.75h5zM227.5 175l-5-5v8.75h5zM232.5 178.75h5V175l-5-5zM242.5 178.75h5V175l-5-5zM252.5 178.75h5V175l-5-5zM262.5 178.75h5V175l-5-5zM207.5 240v-3.75l-5-5V240zM217.5 236.25l-5-5V240h5zM227.5 236.25l-5-5V240h5zM237.5 236.25l-5-5V240h5zM242.5 240h5v-3.75l-5-5zM252.5 240h5v-3.75l-5-5zM262.5 240h5v-3.75l-5-5zM207.5 255l-5-5v8.75h5zM217.5 255l-5-5v8.75h5zM227.5 255l-5-5v8.75h5zM237.5 255l-5-5v8.75h5zM242.5 258.75h5V255l-5-5zM252.5 258.75h5V255l-5-5zM262.5 258.75h5V255l-5-5zM272.5 258.75h5V255l-5-5zM207.5 316.25l-5-5V320h5zM217.5 316.25l-5-5V320h5zM227.5 316.25l-5-5V320h5zM237.5 316.25l-5-5V320h5zM242.5 320h5v-3.75l-5-5zM252.5 320h5v-3.75l-5-5zM262.5 320h5v-3.75l-5-5zM272.5 320h5v-3.75l-5-5zM207.5 335l-5-5v8.75h5zM217.5 335l-5-5v8.75h5zM227.5 335l-5-5v8.75h5zM237.5 335l-5-5v8.75h5zM242.5 338.75h5V335l-5-5zM252.5 338.75h5V335l-5-5zM262.5 338.75h5V335l-5-5zM272.5 338.75h5V335l-5-5zM207.5 396.25l-5-5V400h5zM217.5 396.25l-5-5V400h5zM227.5 396.25l-5-5V400h5zM237.5 396.25l-5-5V400h5zM242.5 400h5v-3.75l-5-5zM252.5 400h5v-3.75l-5-5zM262.5 400h5v-3.75l-5-5zM272.5 400h5v-3.75l-5-5zM207.5 415l-5-5v8.75h5zM217.5 415l-5-5v8.75h5zM227.5 415l-5-5v8.75h5zM237.5 415l-5-5v8.75h5zM242.5 418.75h5V415l-5-5zM252.5 418.75h5V415l-5-5zM262.5 418.75h5V415l-5-5zM272.5 418.75h5V415l-5-5zM202.5 480h8.75l-8.75-8.75zM232.5 480h8.75l-8.75-8.75zM252.5 480h8.75l-8.75-8.75z'/>
            <text x='400' y='325' font-size='256'>{Clue}</text>
        </g>";

        public static IList<KyuConstraint> Generate(int[] sudoku)
        {
            var constraints = new List<KyuConstraint>();
            foreach (var isCol in new[] { false, true })
                foreach (var reverse in new[] { false, true })
                    for (var rowCol = 0; rowCol < 9; rowCol++)
                        constraints.Add(new Skyscraper(isCol, rowCol, reverse, SkyscraperUniquenessConstraint.CalculateSkyscraperClue(Ut.NewArray(9, x => sudoku[isCol ? (rowCol + 9 * (reverse ? 8 - x : x)) : ((reverse ? 8 - x : x) + 9 * rowCol)]))));
            return constraints;
        }
    }
}